
## Overview

This repository contains MATLAB scripts, classes and functions for processing impulsive Raman diffusion data stimulated by the spectral decaling method. The processing pipeline involves various steps, from loading and normalizing data to generating Raman spectra and optimizing image quality. The code is designed to work with data files generated by LabView in the form of .ASC, .XML, and .TXT files.

These files are organized into five folders, sharing identical names except for the suffix indicating the spectral delay. As a result, our data processing involves extracting information from folders of the following structure: 

> &#128193; KL_CBZDH2610_Nik20xLWD_NikCond_1_acc_50ohm_chanAB_50mW_TiSa_50mW_OPO1040_Dazz_minus23kfs2_RF20_APE_310_48dB_100ns_FG_12MHZ_GP_1p5mm_noQWP_HWPTiSa230_OPO328_**0psdelay**

## Requirements

Ensure you have MATLAB installed, preferably version **R2023a** or a more recent release, with the following toolboxes:

- *Computer Vision Toolbox, version 10.4*
- *Curve Fitting Toolbox, version 3.9*
- *Image Acquisition Toolbox, version 6.7.1*
- *Image Processing Toolbox, version 11.7*
- *RF Toolbox, version 4.5*
- *Signal Integrity Toolbox, version 13*
- *Signal Processing Toolbox, version 9.2*
- *Statistics and Machine Learning Toolbox, version 12.5*
- *Symbolic Math Toolbox, version 9.3*

## Getting Started

1. Clone this repository to your local machine.

2. Open MATLAB and navigate to the repository directory.

3. Set the path to the folder containing the five folders to be analyzed. Example:

    ```matlab
    dataPath = 'C:\Users\phdin\Desktop\Data_Paulo\210507';
    ```

4. Open the `Raman_processing_main.m` and put your path in the cd(path) and addpath(path) line. Choose the number of the experiment you want to work on, if you have 50 folders within your path corresponding to 10 experiments, and you want to choose experiment 7, change the xp_number to 7.

## Organization 

To process post-experiment data, we created the `Raman_Processing.m` class, which controls all the steps necessary for processing process data. The `Raman_processing_main.m` file is the script that executes what we want to do in this treatment.

To optimize the code, we use the `RmFast.m` class and the `RmFast_Main.m` script. The performance of code execution is essential so that we can work at the video rate. This code is a shorter code, but it uses the results of the analysis carried out in the previous data processing code. It is a code that tries to optimize the time but also the quality of the Raman image.

We'll start with the code for post-treatment, running the `Raman_processing_main.m` script will create an object called RP that will be updated when each method is executed.

## 1. Data Loading 

The first method is `choose_folders_load_data`. Firstly, it takes the name of the folders (like the example above) and gets from them the characteristics and parameters of the *Function Generator*, *Lockin*, *Objectives*, *LabView*, *Laser*, *Dazzler* and *Polarization*. From the .ASC file it will take the raw data, and other experiment parameters will be taken from the .TXT and .XML files.

## 2. Preprocessing
  ### 2.1 Eliminating Initial Impulse
  After that, the script executes the `window_overlap` method which will take *tukey_window_param* and *percent_FWHM* as parameters. This function serves to remove the large value of the signal caused by the initial impulse, therefore, it will only be removed from the first folder that contains data from 0ps to ~3ps. The *percent_FWHM* value is the percentage used of the full width at half maximum value of the square of the absolute value of the raw curve integral. We found that the 100% value leaves the value of the initial impulse insignificant in relation to the oscillation produced in the studied species, however, a window showing all these curves will open to the user to ratify or change this value. The *tukey_window_param value* indicates the percentage of the Tukey window used to smooth this initially made cut.
  ### 2.2 Normalization and centralization
  After that, the script executes the `Tnorm_and_center_data` method that normalizes and centers the data.
  ### 2.3 Stitching and interpolating
  The `stitch_time_axis_T_with_interp` method interpolates the data from the first folder with the initial impulse cut and the four other folders. For the issue of image quality, the interpolation done by the *makima* method is better done, but for performance it is the slowest, therefore it will be used in post-processing analysis but not in the performance code.
  ### 2.4 Windowing
  After interpolating the entire signal, we proceed to apply a window across its entirety. MATLAB provides over 16 window options, all of which are also accessible in our program. Users have the flexibility to select the specific ratio they wish to employ for this window, tailoring the processing to their preferences.
  
## 3. Fourier Transform, Raman Spectrum and Hyperspectral Images

Following this step, the Fourier transform is executed using the `FT` method, and subsequently, the Raman spectrum is generated by `make_raman_spectrum` method.

## 4. Collecting image quality data

After the previous step, a data cube with the hyperspectral images is created. At this point we can analyze each image related to a certain wave number. Using the `calculated_images_scores_per_wn` method, we collect information about image quality methods, use the *SSIM* (broadcast image based reference method) and the unreferenced methods *piqe*, *niqe*, and *brisque*, and save these values for later analyse.

## 5. Peak Detection and Signal Analysis


## 4. Visualization and Analysis

% ... (Your code for visualization and analysis)

## GIFs

% ... (Instructions or links to GIFs demonstrating the code in action)
